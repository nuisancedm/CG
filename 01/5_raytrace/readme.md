# 以下是笔记

# Shadow map

在以往着色流程中，我们只对一个shading point进行着色，只考虑这个shading point自己的法线，光源方向，观察方向，uv坐标等属性，而不考虑场景中其他地方对这个shading point的影响。而这是不正确的，因为当这个shading point和光源之间有东西阻挡的时候，这样的做法不会正确的计算阴影。

shadow mappping是在光栅化流程下实现阴影的主要方法。  

* shadow mapping在计算阴影的时候不知道场景的几何信息。
* shadow mapping会有走样问题。
* 主要思想：如果一个点不在阴影了，那么它一定能够同**时被摄像机和光源看到**。
* 经典的shadow mapping只能处理点光源的阴影，这些阴影都是硬阴影，都有明显的阴影边界。

**shadow mappping 第一步**： 我们在点光源处放置一个相机，在这个位置进行一遍光栅化，我们就能得到光源能看到的点的深度。  
**shadow mappping 第二步**： 从真正的相机看场景，对所有真正相机看到的点的坐标**投影**回光源相机下的坐标。将投影回光源相机的坐标的深度和原本光源相机下记录的深度对比，如果两个深度一致，那么该点不是阴影点。  

总结：shadow mapping是一个两趟的过程，尽管他有很多问题，阴影图的分辨率会影响质量，且只能处理点光源硬阴影，且会受到浮点数精度影响，但是他仍然是目前主流的制作阴影的方法。
